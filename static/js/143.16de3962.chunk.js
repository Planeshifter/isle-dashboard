(window.webpackJsonp=window.webpackJsonp||[]).push([[143],{1367:function(e,t,a){"use strict";var s=a(16),n=a(1),r=a.n(n),l=a(1048),i=a(511),c=a(502),o=a(1368),m=a(490);t.a=Object(l.a)(["header_bar","common"])((function(e){return r.a.createElement(i.a,{style:Object(s.a)({width:"14vw",minWidth:"120px",float:"left",marginBottom:"4px",marginRight:"5px"},e.style)},r.a.createElement(o.a,null,r.a.createElement(c.a,{className:"header-bar-search",type:"text",placeholder:e.placeholder,value:e.value,onChange:e.onChange,"aria-label":e.t("search-field")}),r.a.createElement(o.a.Append,null,r.a.createElement(m.a,{"aria-label":e.t("search-field-icon"),disabled:!0,variant:"secondary",style:{cursor:"auto"}},r.a.createElement("i",{className:"fa fa-search"})))))}))},3982:function(e,t,a){"use strict";a.r(t);var s=a(16),n=a(12),r=a(13),l=a(27),i=a(20),c=a(39),o=a(50),m=a(1),d=a.n(m),p=a(30),h=a.n(p),u=a(1048),f=a(496),v=a(590),E=a(684),y=a(505),g=a(904),b=a(581),k=a(522),w=a(490),S=a(1016),x=a(873),A=a(1402),T=a.n(A),D=a(550),O=a.n(D),j=a(41),N=a.n(j),z=a(966),B=a.n(z),P=a(2216),U=a.n(P),C=a(1367),I=a(5),q=a(853),R=a(703),F=a(628),H=a(627);function _(e){var t=[];if(!e)return t;for(var a=1;a<e.length;a++){var s=e[a]-e[a-1];t.push(s)}return t}function L(e){switch(e){case"left":return"right";case"right":return"left";case"up":return"down";case"down":return"up"}}var M=h()("isle-dashboard:admin"),J=[0,.9,.1,.8,.2,.7,.3],G={users:q.a[0],namespaces:q.a[1],lessons:q.a[2],cohorts:q.a[3],files:q.a[4],events:q.a[5],sessionData:q.a[7],dailyActiveUsers:q.a[8],weeklyActiveUsers:q.a[9],monthlyActiveUsers:q.a[10],tickets:q.a[11],closedTickets:q.a[12],openTickets:q.a[13]},Y={users:"nUsers",namespaces:"nNamespaces",lessons:"nLessons",cohorts:"nCohorts",files:"nFiles",events:"nEvents",sessionData:"nSessionData",tickets:"nTickets",openTickets:"nOpenTickets",closedTickets:"nClosedTickets",dailyActiveUsers:"dailyActiveUsers",weeklyActiveUsers:"weeklyActiveUsers",monthlyActiveUsers:"monthlyActiveUsers"},V={users:!1,namespaces:!1,lessons:!1,cohorts:!1,files:!1,events:!1,sessionData:!1,dailyActiveUsers:!1,weeklyActiveUsers:!1,monthlyActiveUsers:!1,tickets:!1,openTickets:!1,closedTickets:!1},W=["sendDataToCloud","zoom2d","pan2d","select2d","zoomIn2d","zoomOut2d","autoScale2d","resetScale2d","hoverClosestCartesian","hoverCompareCartesian","toggleHover","toggleSpikelines","resetViews"],K=function(e){Object(i.a)(a,e);var t=Object(c.a)(a);function a(e){var r;return Object(n.a)(this,a),r=t.call(this,e),Object(o.a)(Object(l.a)(r),"hideExplorer",(function(){r.setState({dataExplorer:"hidden"})})),Object(o.a)(Object(l.a)(r),"handleFilterChange",(function(e){for(var t=U()(e.target.value),a=[],s=0;s<r.props.statistics.actionTypes.length;s++){var n=r.props.statistics.actionTypes[s];if(n)(n._id.type||"").includes(t)&&a.push(n)}r.setState({filteredActionTypes:a})})),Object(o.a)(Object(l.a)(r),"renderExplorer",(function(){var e;switch(r.state.dataExplorer){case"action-types":e=d.a.createElement(H.a,{title:r.props.t("explorer-action-types-title"),data:Object(s.a)(Object(s.a)({},r.state.historicalActionTypes),{},{time:r.props.historicalStatistics.map((function(e){return e.createdAt}))}),categorical:["time"],close:r.hideExplorer});break;case"overview-statistics":e=d.a.createElement(H.a,{title:r.props.t("explorer-overview-stats-title"),data:Object(F.a)(r.props.historicalStatistics),categorical:["createdAt"],close:r.hideExplorer})}return e})),r.state={displayInPlot:Object(s.a)(Object(s.a)({},V),{},{users:!0}),revision:0,filteredActionTypes:e.statistics.actionTypes,historicalActionTypes:null,useDifferencing:!1,dataExplorer:"hidden"},r}return Object(r.a)(a,[{key:"componentDidMount",value:function(){this.props.getOverviewStatistics();var e=this.props.historicalStatistics[this.props.historicalStatistics.length-1];if(e&&e.updatedAt){var t=new Date(e.updatedAt),a=t.getFullYear(),s=t.getMonth(),n=t.getDate();M("Latest data from ".concat(s,"/").concat(n,"/").concat(a,"..."));var r=new Date,l=r.getFullYear(),i=r.getMonth(),c=r.getDate();M("Current date is ".concat(i,"/").concat(c,"/").concat(l)),(l>a||i>s||c>n)&&(M("Request historical data from server..."),this.props.getHistoricalOverviewStats())}else M("Retrieve overview data..."),this.props.getHistoricalOverviewStats();this.props.historicalStatistics&&this.extractHistoricalActionTypes()}},{key:"componentDidUpdate",value:function(e){this.props.statistics.actionTypes!==e.statistics.actionTypes&&this.setState({filteredActionTypes:this.props.statistics.actionTypes}),this.props.historicalStatistics.length!==e.historicalStatistics.length&&this.extractHistoricalActionTypes()}},{key:"extractHistoricalActionTypes",value:function(){M("Extract and format action types for time series display...");for(var e=B()(this.props.historicalStatistics,"actionTypes"),t={},a=0;a<e.length;a++)if(e[a])for(var s=0;s<e[a].length;s++){var n=e[a][s],r=n._id.type;t[r]||(t[r]=[]),t[r][a]=n.count}this.setState({historicalActionTypes:t})}},{key:"renderTimeSeries",value:function(){for(var e=this,t="",a=this.props.historicalStatistics,n=B()(a,"createdAt"),r=[n[0],n[n.length-1]],l={xaxis:{autorange:!0,range:r,rangeselector:{buttons:[{count:7,label:"1w",step:"day",stepmode:"backward"},{count:1,label:"1m",step:"month",stepmode:"backward"},{count:6,label:"6m",step:"month",stepmode:"backward"},{step:"all"}]},rangeslider:{range:r},type:"date",fixedrange:!0},legend:{orientation:"h"},margin:{l:10,r:15,b:30,t:30,pad:10}},i=N()(this.state.displayInPlot),c=[],o=[0,1],p=0;p<i.length;p++){var h=i[p];if(!0===this.state.displayInPlot[h]){t+=""===t?"":", ",t+=this.props.t("common:"+h);var u=void 0,f=void 0;G[h]?(u=G[h],f=B()(a,Y[h])):(u=q.a[p%q.a.length+7],f=this.state.historicalActionTypes[h]),this.state.useDifferencing&&(f=_(f));var v={type:this.state.useDifferencing?"bar":"scatter",mode:"line",name:this.props.t("common:"+h),x:n,y:f,marker:{color:u}};this.state.useDifferencing&&(v.offsetgroup=c.length);var y=c.length;y>0&&(v.yaxis="y".concat(y+1)),c.push(v);var g={title:this.props.t("common:"+h),titlefont:{color:u},tickfont:{color:u},fixedrange:!0};c.length>1&&(g.overlaying="y"),c.length%2===0?(g.side="left",o[0]+=.1):(g.side="right",o[1]-=.1),g.position=J[c.length],0===y?l.yaxis=g:l["yaxis".concat(y+1)]=g}}return l.xaxis.domain=o,l.title="".concat(this.state.useDifferencing?this.props.t("daily-changes-of"):this.props.t("time-series-of")).concat(t),0===c.length?d.a.createElement(E.a,{style:{width:"100%",height:"73.7%"}},d.a.createElement("h3",{style:{textAlign:"center",marginTop:"12%"}},"Select a variable to be displayed...")):d.a.createElement(m.Fragment,null,d.a.createElement(T.a,{revision:this.state.revision,data:c,config:{displayModeBar:"hover",displaylogo:!1,modeBarButtonsToRemove:W,modeBarButtonsToAdd:[{name:this.props.t("download-data"),icon:{width:857.1,height:1e3,path:"m214-7h429v214h-429v-214z m500 0h72v500q0 8-6 21t-11 20l-157 156q-5 6-19 12t-22 5v-232q0-22-15-38t-38-16h-322q-22 0-37 16t-16 38v232h-72v-714h72v232q0 22 16 38t37 16h465q22 0 38-16t15-38v-232z m-214 518v178q0 8-5 13t-13 5h-107q-7 0-13-5t-5-13v-178q0-8 5-13t13-5h107q7 0 13 5t5 13z m357-18v-518q0-22-15-38t-38-16h-750q-23 0-38 16t-16 38v750q0 22 16 38t38 16h517q23 0 50-12t42-26l156-157q16-15 27-42t11-49z",transform:"matrix(1 0 0 -1 0 850)"},click:function(e){var a=new Blob([JSON.stringify(e.data)],{type:"application/json"});Object(R.a)(a,"stats_".concat(t,".json"))}}]},layout:l,style:{width:"100%",height:"80%"},useResizeHandler:!0}),c.length>0?d.a.createElement(m.Fragment,null,d.a.createElement(w.a,{onClick:function(){e.setState({displayInPlot:Object(s.a)({},V),revision:e.state.revision+1})},style:{marginLeft:"35%"}},this.props.t("common:reset")),d.a.createElement(w.a,{onClick:function(){e.setState({useDifferencing:!e.state.useDifferencing})},style:{marginLeft:"1%"}},this.state.useDifferencing?"Display Time Series":this.props.t("display-daily-changes"))):null)}},{key:"renderDiskUsage",value:function(){if(!this.props.statistics.database)return null;var e=this.props.statistics.database,t=e.fsUsedSize,a=e.fsTotalSize;t/=1073741824,a/=1073741824;var s=O()(t),n=O()(a-t),r=this.props.t;return d.a.createElement(T.a,{data:[{values:[s,n],labels:["".concat(r("used-space"),": ").concat(s," GB"),"".concat(r("free-space"),": ").concat(n," GB")],type:"pie"}],config:{displayModeBar:!1,displaylogo:!1},layout:{plot_bgcolor:"rgba(0,0,0,0.0)",paper_bgcolor:"rgba(0,0,0,0.0)",xaxis:{fixedrange:!0},yaxis:{fixedrange:!0},autosize:!0,margin:{l:50,r:50,b:50,t:50}},useResizeHandler:!0,style:{width:"75%",height:"200px"}})}},{key:"renderDatabaseStats",value:function(){var e=this.props.t;if(!this.props.statistics.database)return null;var t=this.props.statistics.database,a=t.storageSize,s=t.dataSize,n=t.objects,r=t.avgObjSize;return d.a.createElement(x.a,{variant:"flush",style:{fontSize:"1em"}},d.a.createElement(x.a.Item,{style:{padding:".5rem 0.8rem"}},e("physical-storage-size"),": ",a),d.a.createElement(x.a.Item,{style:{padding:".5rem 0.8rem"}},e("reserved-storage-size"),": ",s),d.a.createElement(x.a.Item,{style:{padding:".5rem 0.8rem"}},e("number-of-objects"),": ",n," "),d.a.createElement(x.a.Item,{style:{padding:".5rem 0.8rem"}},e("average-object-size"),": ",O()(r)))}},{key:"renderDailyStatistics",value:function(){var e=this.props.t,t=this.props.statistics,a=t.dailyActiveUsers,s=t.weeklyActiveUsers,n=t.monthlyActiveUsers,r=t.lastHourActiveUsers;return d.a.createElement(x.a,{variant:"flush",style:{fontSize:"1em"}},d.a.createElement(x.a.Item,{style:{padding:".5rem 0.8rem"}},e("last-hour-active-users"),":",d.a.createElement("span",{style:{float:"right",marginRight:56}},r)),d.a.createElement(x.a.Item,{style:{padding:".5rem 0.8rem"}},d.a.createElement("span",null,e("daily-active-users"),":"),d.a.createElement("span",{style:{float:"right"}},d.a.createElement("span",{style:{marginRight:24}},a),this.renderPlotButton("dailyActiveUsers","down"))),d.a.createElement(x.a.Item,{style:{padding:".5rem 0.8rem"}},d.a.createElement("span",null,e("weekly-active-users"),":"),d.a.createElement("span",{style:{float:"right"}},d.a.createElement("span",{style:{marginRight:24}},s),this.renderPlotButton("weeklyActiveUsers","down"))),d.a.createElement(x.a.Item,{style:{padding:".5rem 0.8rem"}},d.a.createElement("span",null,e("monthly-active-users"),":"),d.a.createElement("span",{style:{float:"right"}},d.a.createElement("span",{style:{marginRight:24}},n),this.renderPlotButton("monthlyActiveUsers","down"))))}},{key:"renderActionTypes",value:function(){var e=this,t=this.state.filteredActionTypes;return t?d.a.createElement(m.Fragment,null,d.a.createElement("h2",null,this.props.t("common:actions"),d.a.createElement(f.a,{placement:"right",overlay:d.a.createElement(y.a,{id:"explorer-action-types-tooltip"},this.props.t("common:data-explorer"))},d.a.createElement(w.a,{onClick:function(){e.setState({dataExplorer:"action-types"})},style:{marginLeft:12}},d.a.createElement("i",{className:"fas fa-chart-bar"}))),d.a.createElement(C.a,{style:{position:"absolute",top:0,right:8,width:140,fontSize:"1.2rem"},placeholder:"Search...",onChange:this.handleFilterChange})),d.a.createElement("div",{className:"action-types-table-container"},d.a.createElement(S.a,{striped:!0,hover:!0,className:"action-types-table",size:"sm"},d.a.createElement("thead",null,d.a.createElement("tr",null,d.a.createElement("th",null,this.props.t("common:visualize")),d.a.createElement("th",null,this.props.t("common:type")),d.a.createElement("th",null,this.props.t("common:count")))),d.a.createElement("tbody",null,t.map((function(t,a){return d.a.createElement("tr",{key:a},d.a.createElement("td",null,e.renderPlotButton(t._id.type,"right")),d.a.createElement("td",null,t._id.type),d.a.createElement("td",null,t.count))})))))):null}},{key:"renderPlotButton",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"left",n=arguments.length>2?arguments[2]:void 0,r=function(){var a=Object(s.a)({},t.state.displayInPlot);a[e]=!a[e],t.setState({displayInPlot:V},(function(){t.setState({displayInPlot:a,revision:t.state.revision+1})}))};return this.state.displayInPlot[e]?d.a.createElement(w.a,{variant:"warning",size:"sm",onClick:r},d.a.createElement("i",{className:n||"fas fa-arrow-circle-".concat(a)})):d.a.createElement(w.a,{variant:"secondary",size:"sm",onClick:r},d.a.createElement("i",{className:n||"fas fa-arrow-circle-".concat(L(a))}))}},{key:"render",value:function(){var e=this;M("Rendering overview page...");var t=this.props.statistics,a=t.nUsers,s=t.nNamespaces,n=t.nLessons,r=t.nCohorts,l=t.nSessionData,i=t.nFiles,c=t.nEvents,o=t.nTickets,m=this.props.t,p=d.a.createElement(g.a,{className:"admin-outer-container slide-in-right"},d.a.createElement(b.a,{className:"first-row"},d.a.createElement(k.a,{className:"column-border",sm:4,md:3},d.a.createElement("h2",null,this.props.t("overall"),d.a.createElement(f.a,{placement:"right",overlay:d.a.createElement(y.a,{id:"explorer-overview-tooltip"},m("common:data-explorer"))},d.a.createElement(w.a,{onClick:function(){e.setState({dataExplorer:"overview-statistics"})},style:{marginLeft:12}},d.a.createElement("i",{className:"fas fa-chart-bar"}))),d.a.createElement("span",{className:"overview-server-name"},I.a)),d.a.createElement(S.a,{striped:!0,hover:!0,className:"overview-table"},d.a.createElement("thead",null,d.a.createElement("tr",null,d.a.createElement("th",null,this.props.t("common:icon")),d.a.createElement("th",null,this.props.t("common:table")),d.a.createElement("th",null,this.props.t("common:count")),d.a.createElement("th",null,this.props.t("common:visualize")))),d.a.createElement("tbody",null,d.a.createElement("tr",null,d.a.createElement("td",null,d.a.createElement("i",{className:"fas fa-user",style:{color:G.users}})),d.a.createElement("td",null,m("admin:users")),d.a.createElement("td",null,a),d.a.createElement("td",null,this.renderPlotButton("users"))),d.a.createElement("tr",null,d.a.createElement("td",null,d.a.createElement("i",{className:"fas fa-school",style:{color:G.namespaces}})),d.a.createElement("td",null,m("common:courses")),d.a.createElement("td",null,s),d.a.createElement("td",null,this.renderPlotButton("namespaces"))),d.a.createElement("tr",null,d.a.createElement("td",null,d.a.createElement("i",{className:"fas fa-chalkboard",style:{color:G.lessons}})),d.a.createElement("td",null,m("common:lessons")),d.a.createElement("td",null,n),d.a.createElement("td",null,this.renderPlotButton("lessons"))),d.a.createElement("tr",null,d.a.createElement("td",null,d.a.createElement("i",{className:"fas fa-users",style:{color:G.cohorts}})),d.a.createElement("td",null,m("common:cohorts")),d.a.createElement("td",null,r),d.a.createElement("td",null,this.renderPlotButton("cohorts"))),d.a.createElement("tr",null,d.a.createElement("td",null,d.a.createElement("i",{className:"fas fa-file",style:{color:G.files}})),d.a.createElement("td",null,m("common:files")),d.a.createElement("td",null,i),d.a.createElement("td",null,this.renderPlotButton("files"))),d.a.createElement("tr",null,d.a.createElement("td",null,d.a.createElement("i",{className:"fas fa-clock",style:{color:G.events}})),d.a.createElement("td",null,m("common:events")),d.a.createElement("td",null,c),d.a.createElement("td",null,this.renderPlotButton("events"))),d.a.createElement("tr",null,d.a.createElement("td",null,d.a.createElement("i",{className:"fas fa-shoe-prints",style:{color:G.sessionData}})),d.a.createElement("td",null,m("common:sessionData")),d.a.createElement("td",null,l),d.a.createElement("td",null,this.renderPlotButton("sessionData"))),d.a.createElement("tr",null,d.a.createElement("td",null,d.a.createElement("i",{className:"fas fa-medkit",style:{color:G.tickets}})),d.a.createElement("td",null,m("common:tickets")),d.a.createElement("td",null,o),d.a.createElement("td",null,d.a.createElement(v.a,null,this.renderPlotButton("tickets"),this.renderPlotButton("openTickets","left","fas fa-lock-open"),this.renderPlotButton("closedTickets","left","fas fa-lock"))))))),d.a.createElement(k.a,{className:"column-border",sm:8,md:6},d.a.createElement("h2",null,this.props.t("over-time")),this.renderTimeSeries()),d.a.createElement(k.a,{sm:12,md:3},this.renderActionTypes())),d.a.createElement(b.a,{className:"second-row"},d.a.createElement(k.a,{md:3,sm:4,className:"column-border"},d.a.createElement("h3",null,m("disk-usage")),this.renderDiskUsage()),d.a.createElement(k.a,{md:6,sm:8,className:"column-border"},d.a.createElement("h3",null,m("database")),this.renderDatabaseStats()),d.a.createElement(k.a,{md:3,sm:12},d.a.createElement("h3",null,this.props.t("daily-statistics")),this.renderDailyStatistics())));return"hidden"===this.state.dataExplorer?p:this.renderExplorer()}}]),a}(m.Component);K.defaultProps={historicalStatistics:[],statistics:{}},t.default=Object(u.a)(["admin","common"])(K)},627:function(e,t,a){"use strict";var s=a(10),n=Object(s.a)((function(){return Promise.all([a.e(61),a.e(145)]).then(a.bind(null,894))}));t.a=n},853:function(e,t,a){"use strict";t.a=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#c49c94","#e377c2","#17becf","#aec7e8","#ffbb78","#ff9896","#98df8a","#7f7f7f","#c5b0d5","#f7b6d2","#bcbd22","#c7c7c7","#dbdb8d","#9edae5"]}}]);
//# sourceMappingURL=143.16de3962.chunk.js.map