{"version":3,"sources":["../node_modules/@isle-project/components/word-cloud/main.js","../node_modules/@isle-project/utils/svg/index.js","../node_modules/@stdlib/stdlib/lib/node_modules/@stdlib/datasets/savoy-stopwords-fin/lib/browser.js","../node_modules/@stdlib/stdlib/lib/node_modules/@stdlib/datasets/savoy-stopwords-fr/lib/browser.js","../node_modules/@stdlib/stdlib/lib/node_modules/@stdlib/datasets/savoy-stopwords-ger/lib/browser.js","../node_modules/@stdlib/stdlib/lib/node_modules/@stdlib/datasets/savoy-stopwords-it/lib/browser.js","../node_modules/@stdlib/stdlib/lib/node_modules/@stdlib/datasets/savoy-stopwords-por/lib/browser.js","../node_modules/@stdlib/stdlib/lib/node_modules/@stdlib/datasets/savoy-stopwords-sp/lib/browser.js","../node_modules/@stdlib/stdlib/lib/node_modules/@stdlib/datasets/savoy-stopwords-swe/lib/browser.js","../node_modules/@stdlib/stdlib/lib/node_modules/@stdlib/datasets/stopwords-en/lib/browser.js","../node_modules/@stdlib/stdlib/lib/node_modules/@stdlib/string/remove-punctuation/lib/index.js","../node_modules/@stdlib/stdlib/lib/node_modules/@stdlib/string/remove-punctuation/lib/remove_punctuation.js","../node_modules/d3-cloud/index.js"],"names":["addResources","fill","scaleOrdinal","schemeCategory10","RE_NUMBERS","createBagOfWords","texts","stopwords","minCount","customStopwords","isArray","length","min","PINF","max","NINF","wordCounts","concat","tokens","i","text","isString","removePunctuation","replace","newTokens","tokenize","lowercase","contains","splice","bagOfWords","objectEntries","map","arr","value","filtered","push","Wrapper","props","word","state","name","width","height","svgString","getSVGString","svg","node","svgString2Image","dataBlob","saveAs","id","language","STOPWORDS_EN","STOPWORDS_FIN","STOPWORDS_FR","STOPWORDS_GER","STOPWORDS_IT","STOPWORDS_POR","STOPWORDS_SP","STOPWORDS_SWE","generateStopwords","precalculated","data","slice","nRecords","this","addWordCloud","nextProps","absdiff","updateThreshold","triggerRender","x","y","nobs","guessEquality","updateWordCloud","setState","fontSizeMapper","select","findDOMNode","selectAll","remove","append","attr","style","cloudLayout","cloud","size","font","words","padding","rotate","fontSize","on","d","transition","duration","enter","onClick","exit","start","stop","position","saveButton","placement","tooltip","t","variant","saveToPNG","right","top","zIndex","aria-label","className","prevState","newState","Component","defaultProps","withTranslation","svgNode","setAttribute","cssText","element","styleElement","document","createElement","innerHTML","children","refNode","insertBefore","appendCSS","parentElement","selectorTextArr","classList","c","nodes","getElementsByTagName","classes","extractedCSSText","styleSheets","s","cssRules","e","r","selectorText","getCSSStyles","XMLSerializer","serializeToString","callback","imgsrc","btoa","unescape","encodeURIComponent","canvas","context","getContext","image","Image","onload","clearRect","drawImage","toBlob","blob","filesize","round","src","module","exports","RE","str","TypeError","dispatch","cloudRadians","Math","PI","ch","cloudText","cloudFont","cloudFontNormal","cloudFontSize","sqrt","cloudRotate","random","cloudPadding","cloudSprite","contextAndRatio","di","sprite","ratio","maxh","n","save","weight","w","measureText","h","sr","sin","cr","cos","wcr","wsr","hcr","hsr","abs","cw","translate","fillText","lineWidth","strokeText","restore","xoff","yoff","x1","y1","x0","y0","hasText","pixels","getImageData","w32","seen","seenRow","j","k","m","cloudCollide","tag","board","sw","last","lx","sx","msx","cloudBounds","bounds","b0","b1","archimedeanSpiral","cloudCanvas","functor","fontStyle","fontWeight","spiral","timeInterval","Infinity","event","timer","place","dxdy","dx","dy","a","b","startX","startY","maxDelta","dt","_","arguments","fillStyle","strokeStyle","textAlign","zeroArray","tags","call","sort","clearInterval","setInterval","step","Date","now","spirals","apply","archimedean","rectangular","sign"],"mappings":"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","file":"static/js/WordCloud.42f59132.chunk.js","sourcesContent":["// MODULES //\n\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { findDOMNode } from 'react-dom';\nimport { withTranslation } from 'react-i18next';\nimport Button from 'react-bootstrap/Button';\nimport { scaleOrdinal, schemeCategory10, select } from 'd3';\nimport cloud from 'd3-cloud';\nimport saveAs from '@isle-project/utils/file-saver';\nimport absdiff from '@stdlib/math/base/utils/absolute-difference';\nimport min from '@stdlib/math/base/special/min';\nimport removePunctuation from '@stdlib/string/remove-punctuation';\nimport replace from '@stdlib/string/replace';\nimport tokenize from '@stdlib/nlp/tokenize';\nimport contains from '@stdlib/assert/contains';\nimport { isPrimitive as isString } from '@stdlib/assert/is-string';\nimport lowercase from '@stdlib/string/lowercase';\nimport objectEntries from '@stdlib/utils/entries';\nimport isArray from '@stdlib/assert/is-array';\nimport PINF from '@stdlib/constants/math/float64-pinf';\nimport NINF from '@stdlib/constants/math/float64-ninf';\nimport STOPWORDS_EN from '@stdlib/datasets/stopwords-en';\nimport STOPWORDS_FIN from '@stdlib/datasets/savoy-stopwords-fin';\nimport STOPWORDS_FR from '@stdlib/datasets/savoy-stopwords-fr';\nimport STOPWORDS_GER from '@stdlib/datasets/savoy-stopwords-ger';\nimport STOPWORDS_IT from '@stdlib/datasets/savoy-stopwords-it';\nimport STOPWORDS_POR from '@stdlib/datasets/savoy-stopwords-por';\nimport STOPWORDS_SP from '@stdlib/datasets/savoy-stopwords-sp';\nimport STOPWORDS_SWE from '@stdlib/datasets/savoy-stopwords-swe';\nimport Tooltip from '@isle-project/components/tooltip';\nimport { svgString2Image, getSVGString } from '@isle-project/utils/svg';\nimport { addResources } from '@isle-project/locales';\n\n\n// VARIABLES //\n\naddResources( 'WordCloud' );\nconst fill = scaleOrdinal( schemeCategory10 );\nconst RE_NUMBERS = /[+-]?[\\d.]+e?[+-]?\\d*/g;\n\n\n// FUNCTIONS //\n\nconst generateStopwords = ( language ) => {\n\tlet stopwords;\n\tswitch ( language ) {\n\t\tdefault:\n\t\tcase 'en':\n\t\t\tstopwords = STOPWORDS_EN();\n\t\tbreak;\n\t\tcase 'fin':\n\t\t\tstopwords = STOPWORDS_FIN();\n\t\tbreak;\n\t\tcase 'fr':\n\t\t\tstopwords = STOPWORDS_FR();\n\t\tbreak;\n\t\tcase 'ger':\n\t\t\tstopwords = STOPWORDS_GER();\n\t\tbreak;\n\t\tcase 'it':\n\t\t\tstopwords = STOPWORDS_IT();\n\t\tbreak;\n\t\tcase 'por':\n\t\t\tstopwords = STOPWORDS_POR();\n\t\tbreak;\n\t\tcase 'sp':\n\t\t\tstopwords = STOPWORDS_SP();\n\t\tbreak;\n\t\tcase 'swe':\n\t\t\tstopwords = STOPWORDS_SWE();\n\t\tbreak;\n\t}\n\treturn stopwords;\n};\n\nfunction guessEquality( x, y ) {\n\tlet nobs = min( x.length, 10 );\n\tfor ( let i = 0; i < nobs; i++ ) {\n\t\tif ( x[ i ] !== y[ i ] ) {\n\t\t\treturn false;\n\t\t}\n\t}\n\treturn true;\n}\n\nconst createBagOfWords = ({ texts, stopwords, minCount, customStopwords }) => {\n\tif ( !isArray( texts ) || texts.length === 0 ) {\n\t\treturn { min: PINF, max: NINF, wordCounts: []};\n\t}\n\tstopwords = stopwords.concat( customStopwords );\n\tlet tokens = [];\n\tfor ( let i = 0; i < texts.length; i++ ) {\n\t\tlet text = texts[ i ];\n\t\tif ( isString( text ) ) {\n\t\t\ttext = removePunctuation( text );\n\t\t\ttext = replace( text, RE_NUMBERS, ' ' );\n\t\t\tlet newTokens = tokenize( text );\n\t\t\ttokens = tokens.concat( newTokens );\n\t\t}\n\t}\n\tfor ( let i = 0; i < tokens.length; i++ ) {\n\t\ttokens[ i ] = lowercase( tokens[ i ] );\n\t}\n\tfor ( let i = tokens.length; i > 0; i-- ) {\n\t\tif ( tokens[i] && contains( stopwords, lowercase( tokens[i] ) ) ) {\n\t\t\ttokens.splice( i, 1 );\n\t\t}\n\t}\n\tlet bagOfWords = {};\n\tfor ( let i = 0; i < tokens.length; i++ ) {\n\t\tif ( bagOfWords[ tokens[ i ] ] ) {\n\t\t\tbagOfWords[ tokens[ i ] ] += 1;\n\t\t} else {\n\t\t\tbagOfWords[ tokens[ i ] ] = 1;\n\t\t}\n\t}\n\tlet max = NINF;\n\tlet min = PINF;\n\tconst wordCounts = objectEntries( bagOfWords ).map( arr => {\n\t\tif ( arr[ 1 ] > max ) {\n\t\t\tmax = arr[ 1 ];\n\t\t}\n\t\tif ( arr[ 1 ] < min ) {\n\t\t\tmin = arr[ 1 ];\n\t\t}\n\t\treturn {\n\t\t\ttext: arr[ 0 ],\n\t\t\tvalue: arr[ 1 ]\n\t\t};\n\t});\n\tif ( !minCount ) {\n\t\treturn { min, max, wordCounts };\n\t}\n\tconst filtered = [];\n\tfor ( let i = 0; i < wordCounts.length; i++ ) {\n\t\tif ( wordCounts[ i ].value >= minCount ) {\n\t\t\tfiltered.push( wordCounts[ i ] );\n\t\t}\n\t}\n\treturn { min, max, wordCounts: filtered };\n};\n\n\n// MAIN //\n\n/**\n* A word cloud component built on top of [d3-cloud](https://github.com/jasondavies/d3-cloud).\n*\n* @property {Array} data - either an array of texts from which to generate the word cloud or, if `precalculated` is set to `true`, and array of word count objects (with `text` and `value` keys)\n* @property {Function} font - accessor function specifying the font face for each word. Also accepts a constant instead of a function\n* @property {Function} fontSizeMapper - accessor function indicating the font size for each word. Defaults to `( count - min + 1 ) / ( max - min + 6 ) * 30.0 + 12.0`, where `min` and `max` denote the minimum and maximum word `counts`, respectively\n* @property {boolean} precalculated - controls whether the word cloud expects an array of precalculated word counts or will generate them for given texts\n* @property {(Function|number)} rotate - accessor function indicating the rotation angle (in degrees) for each word. Also accepts a constant instead of a function\n* @property {number} width - width of the word cloud (in px)\n* @property {number} height - height of the word cloud (in px)\n* @property {string} language - language identifier (determines the stopwords to be removed)\n* @property {number} minCount - if set, only include words that appear more than `minCount` times in the given data\n* @property {boolean} saveButton - controls whether to display a button for saving the word cloud as an image\n* @property {(Function|number)} padding - accessor function or constant indicating the numerical padding for each word\n* @property {number} updateThreshold - batch size of new documents in `data` before the word cloud is re-rendered\n* @property {boolean} triggerRender - rerender when the data set is exchanged\n* @property {Array} stopwords - additional stopwords to remove before rendering the word cloud\n* @property {Object} style - CSS inline styles\n* @property {Function} onClick - callback function invoked when a word on the word cloud is clicked\n*/\nclass Wrapper extends Component {\n\tconstructor( props ) {\n\t\tsuper( props );\n\n\t\tlet stopwords = generateStopwords( props.language );\n\t\tif ( !props.precalculated ) {\n\t\t\tconst { min, max, wordCounts } = createBagOfWords({\n\t\t\t\ttexts: props.data,\n\t\t\t\tstopwords,\n\t\t\t\tminCount: props.minCount,\n\t\t\t\tcustomStopwords: props.stopwords\n\t\t\t});\n\t\t\tthis.state = {\n\t\t\t\twordCounts,\n\t\t\t\tmin,\n\t\t\t\tmax,\n\t\t\t\tstopwords,\n\t\t\t\tnRecords: props.data.length\n\t\t\t};\n\t\t} else {\n\t\t\tthis.state = {\n\t\t\t\twordCounts: props.data.slice(),\n\t\t\t\tstopwords,\n\t\t\t\tnRecords: props.data.length\n\t\t\t};\n\t\t}\n\t}\n\n\tstatic getDerivedStateFromProps( nextProps, prevState ) {\n\t\tlet newState;\n\t\tif ( !nextProps.precalculated ) {\n\t\t\tconst { min, max, wordCounts } = createBagOfWords({\n\t\t\t\ttexts: nextProps.data,\n\t\t\t\tstopwords: prevState.stopwords,\n\t\t\t\tminCount: nextProps.minCount,\n\t\t\t\tcustomStopwords: nextProps.stopwords\n\t\t\t});\n\t\t\tnewState = {\n\t\t\t\twordCounts,\n\t\t\t\tmin,\n\t\t\t\tmax,\n\t\t\t\tstopwords: prevState.stopwords\n\t\t\t};\n\t\t} else {\n\t\t\tnewState = {\n\t\t\t\twordCounts: nextProps.data.slice()\n\t\t\t};\n\t\t}\n\t\treturn newState;\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.addWordCloud();\n\t}\n\n\tshouldComponentUpdate( nextProps ) {\n\t\tconst diff = absdiff( nextProps.data.length, this.state.nRecords );\n\t\tif (\n\t\t\tdiff >= this.props.updateThreshold ||\n\t\t\t( this.props.triggerRender && !guessEquality( nextProps.data, this.props.data ) ) ||\n\t\t\tnextProps.stopwords.length !== this.props.stopwords.length\n\t\t) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tcomponentDidUpdate() {\n\t\tif ( this.state.wordCounts.length > 0 ) {\n\t\t\tthis.updateWordCloud();\n\t\t}\n\t\tif ( this.state.nRecords !== this.props.data.length ) {\n\t\t\tthis.setState({\n\t\t\t\tnRecords: this.props.data.length\n\t\t\t});\n\t\t}\n\t}\n\n\tfontSizeMapper = ( word ) => {\n\t\tconst { min, max } = this.state;\n\t\tif ( max === min ) {\n\t\t\treturn 50.0;\n\t\t}\n\t\treturn ( word.value - min + 1 ) / ( max - min + 6 ) * 30.0 + 12.0;\n\t}\n\n\taddWordCloud() {\n\t\tconst fontSizeMapper = this.props.fontSizeMapper || this.fontSizeMapper;\n\t\tselect( findDOMNode( this ) )\n\t\t\t.selectAll( 'svg' )\n\t\t\t.remove();\n\t\tthis.svg = select( findDOMNode( this ) )\n\t\t\t.append( 'svg' )\n\t\t\t\t.attr( 'width', this.props.width )\n\t\t\t\t.attr( 'height', this.props.height )\n\t\t\t\t.style( 'background', '#ffffff' );\n\t\tthis.svg.append( 'g' )\n\t\t\t.attr( 'transform', `translate(${this.props.width / 2},${this.props.height / 2})` ); // eslint-disable-line i18next/no-literal-string\n\t\tthis.cloudLayout = cloud()\n\t\t\t.size([ this.props.width, this.props.height ])\n\t\t\t.font( this.props.font )\n\t\t\t.words( this.state.wordCounts )\n\t\t\t.padding( this.props.padding )\n\t\t\t.rotate( this.props.rotate )\n\t\t\t.fontSize( fontSizeMapper )\n\t\t\t.on( 'end', words => {\n\t\t\t\tconst text = this.svg.select( 'g' )\n\t\t\t\t\t.selectAll( 'text' )\n\t\t\t\t\t.data( words, d => d.text );\n\n\t\t\t\ttext.transition()\n\t\t\t\t\t.duration(750)\n\t\t\t\t\t.style( 'font-size', d => `${d.size}px` )\n\t\t\t\t\t.attr( 'transform',\n\t\t\t\t\t\td => `translate(${[d.x, d.y]})rotate(${d.rotate})`\n\t\t\t\t\t);\n\n\t\t\t\ttext.enter()\n\t\t\t\t\t.append( 'text' )\n\t\t\t\t\t.style( 'font-size', d => `${d.size}px` )\n\t\t\t\t\t.style( 'font-family', this.props.font )\n\t\t\t\t\t.style( 'fill', ( d, i ) => fill( i ) )\n\t\t\t\t\t.style( 'cursor', 'pointer' )\n\t\t\t\t\t.attr( 'text-anchor', 'middle' )\n\t\t\t\t\t.attr( 'transform',\n\t\t\t\t\t\td => `translate(${[d.x, d.y]})rotate(${d.rotate})`\n\t\t\t\t\t)\n\t\t\t\t\t.text( d => d.text )\n\t\t\t\t\t.on( 'click', this.props.onClick );\n\n\t\t\t\ttext.exit()\n\t\t\t\t\t.transition()\n\t\t\t\t\t.duration( 750 )\n\t\t\t\t\t.style( 'fill-opacity', 1.0e-6 )\n\t\t\t\t\t.remove();\n\t\t\t})\n\t\t\t.start();\n\t}\n\n\tupdateWordCloud( ){\n\t\tconst wordCounts = this.state.wordCounts;\n\t\tthis.cloudLayout\n\t\t\t.stop()\n\t\t\t.words( wordCounts.map( d => {\n\t\t\t\treturn { text: d.text, value: d.value };\n\t\t\t}))\n\t\t\t.start();\n\t}\n\n\tsaveToPNG = () => {\n\t\tconst { width, height } = this.props;\n\t\tconst svgString = getSVGString( this.svg.node() );\n\t\tsvgString2Image( svgString, 2.0*width, 2.0*height, save );\n\n\t\tlet name;\n\t\tif ( this.props.id ) {\n\t\t\tname = this.props.id+'.png';\n\t\t} else {\n\t\t\tname = 'wordcloud.png';\n\t\t}\n\t\tfunction save( dataBlob ) {\n\t\t\tsaveAs( dataBlob, name );\n\t\t}\n\t}\n\n\trender() {\n\t\treturn ( <div style={{ width: this.props.width, position: 'relative', ...this.props.style }} >\n\t\t\t{ this.props.saveButton && this.state.wordCounts.length > 0 ? <Tooltip placement=\"left\" tooltip={this.props.t('save-word-cloud')} >\n\t\t\t\t<Button size=\"sm\" variant=\"light\" onClick={this.saveToPNG} style={{\n\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\tright: -12,\n\t\t\t\t\ttop: -12,\n\t\t\t\t\tzIndex: 2\n\t\t\t\t}} aria-label={this.props.t('save-word-cloud')} >\n\t\t\t\t\t<div className=\"fa fa-save\" />\n\t\t\t\t</Button>\n\t\t\t</Tooltip> : null }\n\t\t</div> );\n\t}\n}\n\n\n// PROPERTIES //\n\nWrapper.defaultProps = {\n\tdata: [],\n\tfont: 'serif',\n\tfontSizeMapper: null,\n\tprecalculated: false,\n\trotate: word => word.value % 360,\n\twidth: 700,\n\theight: 600,\n\tlanguage: 'en',\n\tminCount: null,\n\tsaveButton: true,\n\tupdateThreshold: 5,\n\tstopwords: [],\n\ttriggerRender: true,\n\tpadding: 5,\n\tonClick() {},\n\tstyle: {}\n};\n\nWrapper.propTypes = {\n\tdata: PropTypes.array,\n\tfont: PropTypes.oneOfType([\n\t\tPropTypes.string,\n\t\tPropTypes.func\n\t]),\n\tfontSizeMapper: PropTypes.func,\n\theight: PropTypes.number,\n\tlanguage: PropTypes.oneOf([\n\t\t'en', 'fin', 'fr', 'ger', 'it', 'por', 'sp', 'swe'\n\t]),\n\tminCount: PropTypes.number,\n\tsaveButton: PropTypes.bool,\n\tonClick: PropTypes.func,\n\tpadding: PropTypes.oneOfType([\n\t\tPropTypes.func,\n\t\tPropTypes.number\n\t]),\n\tprecalculated: PropTypes.bool,\n\trotate: PropTypes.oneOfType([\n\t\tPropTypes.func,\n\t\tPropTypes.number\n\t]),\n\tupdateThreshold: PropTypes.number,\n\tstopwords: PropTypes.array,\n\ttriggerRender: PropTypes.bool,\n\tstyle: PropTypes.object,\n\twidth: PropTypes.number\n};\n\n\n// EXPORTS //\n\nexport default withTranslation( 'WordCloud' )( Wrapper );\n","/**\n* Code adapted from Nikita Rokotyan. MIT licensed. Source: http://bl.ocks.org/Rokotyan/0556f8facbaf344507cdc45dc3622177\n*/\n\n// MODULES //\n\nimport isArray from '@stdlib/assert/is-array';\nimport contains from '@stdlib/assert/contains';\nimport round from '@stdlib/math/base/special/round';\n\n\n// FUNCTIONS //\n\nfunction appendCSS( cssText, element ) {\n\tconst styleElement = document.createElement( 'style' );\n\tstyleElement.setAttribute( 'type', 'text/css' );\n\tstyleElement.innerHTML = cssText;\n\tif ( isArray( element.children ) ) {\n\t\tconst refNode = element.children[ 0 ] || null;\n\t\telement.insertBefore( styleElement, refNode );\n\t}\n}\n\nfunction getCSSStyles( parentElement ) {\n\tconst selectorTextArr = [];\n\tselectorTextArr.push( '#'+parentElement.id );\n\tif ( isArray( parentElement.classList ) ) {\n\t\tfor ( let c = 0; c < parentElement.classList.length; c++ ) {\n\t\t\tif ( !contains( selectorTextArr, '.'+parentElement.classList[c] ) ) {\n\t\t\t\tselectorTextArr.push( '.'+parentElement.classList[c] );\n\t\t\t}\n\t\t}\n\t}\n\tconst nodes = parentElement.getElementsByTagName( '*' );\n\tfor ( let i = 0; i < nodes.length; i++ ) {\n\t\tconst id = nodes[i].id;\n\t\tif ( !contains( selectorTextArr, '#'+id ) ) {\n\t\t\tselectorTextArr.push( '#'+id );\n\t\t}\n\t\tconst classes = nodes[i].classList;\n\t\tif ( isArray( classes ) ) {\n\t\t\tfor ( let c = 0; c < classes.length; c++) {\n\t\t\t\tif ( !contains( selectorTextArr, '.'+classes[c] ) ) {\n\t\t\t\t\tselectorTextArr.push( '.'+classes[c] );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tlet extractedCSSText = '';\n\tfor ( let i = 0; i < document.styleSheets.length; i++ ) {\n\t\tconst s = document.styleSheets[i];\n\t\ttry {\n\t\t\tif ( !s.cssRules ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t} catch ( e ) {\n\t\t\t\tif ( e.name !== 'SecurityError' ) {\n\t\t\t\t\tthrow e; // for Firefox\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\tconst cssRules = s.cssRules;\n\t\tfor ( let r = 0; r < cssRules.length; r++ ) {\n\t\t\tif ( contains( selectorTextArr, cssRules[r].selectorText ) ) {\n\t\t\t\textractedCSSText += cssRules[r].cssText;\n\t\t\t}\n\t\t}\n\t}\n\treturn extractedCSSText;\n}\n\n\n// MAIN //\n\nfunction getSVGString( svgNode ) {\n\tsvgNode.setAttribute( 'xlink', 'http://www.w3.org/1999/xlink' );\n\tsvgNode.setAttribute( 'style', 'background: white;' );\n\tconst cssStyleText = getCSSStyles( svgNode );\n\tappendCSS( cssStyleText, svgNode );\n\n\tconst serializer = new XMLSerializer();\n\tlet svgString = serializer.serializeToString( svgNode );\n\tsvgString = svgString.replace(/(\\w+)?:?xlink=/g, 'xmlns:xlink='); // Fix root xlink without namespace\n\tsvgString = svgString.replace(/NS\\d+:href/g, 'xlink:href'); // Safari NS namespace fix\n\n\treturn svgString;\n}\n\nfunction svgString2Image( svgString, width, height, callback ) {\n\tconst imgsrc = 'data:image/svg+xml;base64,'+ btoa( unescape( encodeURIComponent( svgString ) ) ); // Convert SVG string to data URL\n\n\tconst canvas = document.createElement( 'canvas' );\n\tconst context = canvas.getContext( '2d' );\n\n\tcanvas.width = width;\n\tcanvas.height = height;\n\n\tconst image = new Image();\n\timage.onload = function onLoad() {\n\t\tcontext.clearRect( 0, 0, width, height );\n\t\tcontext.drawImage( image, 0, 0, width, height );\n\n\t\tcanvas.toBlob( function onBlob( blob ) {\n\t\t\tconst filesize = round( blob.length/1024 ) + ' KB';\n\t\t\tif ( callback ) {\n\t\t\t\treturn callback( blob, filesize );\n\t\t\t}\n\t\t});\n\t};\n\timage.src = imgsrc;\n}\n\n\n// EXPORTS //\n\nexport { getSVGString, svgString2Image };\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n'use strict'; // MODULES //\n\nvar data = require('./../data/words.json'); // MAIN //\n\n/**\n* Returns a list of Finnish stop words.\n*\n* @returns {StringArray} stop words\n*\n* @example\n* var list = stopwords();\n* // returns [ 'aiemmin', 'aika', 'aikaa', 'aikaan', 'aikaisemmin', ... ]\n*/\n\n\nfunction stopwords() {\n  return data.slice();\n} // EXPORTS //\n\n\nmodule.exports = stopwords;","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n'use strict'; // MODULES //\n\nvar data = require('./../data/words.json'); // MAIN //\n\n/**\n* Returns a list of French stop words.\n*\n* @returns {StringArray} stop words\n*\n* @example\n* var list = stopwords();\n* // returns [ 'a', 'à', 'â', 'abord', 'afin', 'ah', ... ]\n*/\n\n\nfunction stopwords() {\n  return data.slice();\n} // EXPORTS //\n\n\nmodule.exports = stopwords;","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n'use strict'; // MODULES //\n\nvar data = require('./../data/words.json'); // MAIN //\n\n/**\n* Returns a list of German stop words.\n*\n* @returns {StringArray} stop words\n*\n* @example\n* var list = stopwords();\n* // returns [ 'a', 'ab', 'aber', 'ach', ... ]\n*/\n\n\nfunction stopwords() {\n  return data.slice();\n} // EXPORTS //\n\n\nmodule.exports = stopwords;","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n'use strict'; // MODULES //\n\nvar data = require('./../data/words.json'); // MAIN //\n\n/**\n* Returns a list of Italian stop words.\n*\n* @returns {StringArray} stop words\n*\n* @example\n* var list = stopwords();\n* // returns [ 'a', 'abbastanza', 'accidenti', 'ad', 'adesso', ... ]\n*/\n\n\nfunction stopwords() {\n  return data.slice();\n} // EXPORTS //\n\n\nmodule.exports = stopwords;","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n'use strict'; // MODULES //\n\nvar data = require('./../data/words.json'); // MAIN //\n\n/**\n* Returns a list of Portuguese stop words.\n*\n* @returns {StringArray} stop words\n*\n* @example\n* var list = stopwords();\n* // returns [ 'a', 'à', 'adeus', 'agora', 'aí', 'ainda', ... ]\n*/\n\n\nfunction stopwords() {\n  return data.slice();\n} // EXPORTS //\n\n\nmodule.exports = stopwords;","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n'use strict'; // MODULES //\n\nvar data = require('./../data/words.json'); // MAIN //\n\n/**\n* Returns a list of Spanish stop words.\n*\n* @returns {StringArray} stop words\n*\n* @example\n* var list = stopwords();\n* // returns [ 'a', 'acuerdo', 'adelante', 'ademas', 'además', ... ]\n*/\n\n\nfunction stopwords() {\n  return data.slice();\n} // EXPORTS //\n\n\nmodule.exports = stopwords;","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n'use strict'; // MODULES //\n\nvar data = require('./../data/words.json'); // MAIN //\n\n/**\n* Returns a list of Swedish stop words.\n*\n* @returns {StringArray} stop words\n*\n* @example\n* var list = stopwords();\n* // returns [ 'aderton', 'adertonde', 'adjö', 'aldrig', 'alla', 'allas', ... ]\n*/\n\n\nfunction stopwords() {\n  return data.slice();\n} // EXPORTS //\n\n\nmodule.exports = stopwords;","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n'use strict'; // MODULES //\n\nvar data = require('./../data/words.json'); // MAIN //\n\n/**\n* Returns a list of English stop words.\n*\n* @returns {StringArray} stop words\n*\n* @example\n* var list = stopwords();\n* // returns [ 'a', 'about', 'above', 'across', 'actually', ... ]\n*/\n\n\nfunction stopwords() {\n  return data.slice();\n} // EXPORTS //\n\n\nmodule.exports = stopwords;","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n'use strict';\n/**\n* Remove punctuation characters from a string.\n*\n* @module @stdlib/string/remove-punctuation\n*\n* @example\n* var removePunctuation = require( '@stdlib/string/remove-punctuation' );\n*\n* var out = removePunctuation( 'Sun Tzu said: \"A leader leads by example not by force.\"' );\n* // returns 'Sun Tzu said A leader leads by example not by force'\n*\n* out = removePunctuation( 'Double, double, toil and trouble; Fire burn, and cauldron bubble!' ) );\n* // returns 'Double double toil and trouble Fire burn and cauldron bubble'\n*/\n// MODULES //\n\nvar removePunctuation = require('./remove_punctuation.js'); // EXPORTS //\n\n\nmodule.exports = removePunctuation;","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n'use strict'; // MODULES //\n\nvar isString = require('@stdlib/assert/is-string').isPrimitive;\n\nvar replace = require('@stdlib/string/replace'); // VARIABLES //\n\n\nvar RE = /[!\"'(),–.:;<>?`{}|~\\/\\\\\\[\\]]/g; // eslint-disable-line no-useless-escape\n// MAIN //\n\n/**\n* Removes punctuation characters from a string.\n*\n* @param {string} str - input string\n* @throws {TypeError} must provide a string primitive\n* @returns {string} output string\n*\n* @example\n* var str = 'Sun Tzu said: \"A leader leads by example not by force.\"';\n* var out = removePunctuation( str );\n* // returns 'Sun Tzu said A leader leads by example not by force'\n*\n* @example\n* var str = 'Double, double, toil and trouble; Fire burn, and cauldron bubble!';\n* var out = removePunctuation( str );\n* // returns 'Double double toil and trouble Fire burn and cauldron bubble'\n*\n* @example\n* var str = 'This module removes these characters: `{}[]:,!/<>().;~|?\\'\"';\n* var out = removePunctuation( str );\n* // returns 'This module removes these characters '\n*/\n\nfunction removePunctuation(str) {\n  if (!isString(str)) {\n    throw new TypeError('invalid argument. Must provide a string primitive. Value: `' + str + '`.');\n  }\n\n  return replace(str, RE, '');\n} // EXPORTS //\n\n\nmodule.exports = removePunctuation;","// Word cloud layout by Jason Davies, https://www.jasondavies.com/wordcloud/\n// Algorithm due to Jonathan Feinberg, http://static.mrfeinberg.com/bv_ch03.pdf\nvar dispatch = require(\"d3-dispatch\").dispatch;\n\nvar cloudRadians = Math.PI / 180,\n    cw = 1 << 11 >> 5,\n    ch = 1 << 11;\n\nmodule.exports = function () {\n  var size = [256, 256],\n      text = cloudText,\n      font = cloudFont,\n      fontSize = cloudFontSize,\n      fontStyle = cloudFontNormal,\n      fontWeight = cloudFontNormal,\n      rotate = cloudRotate,\n      padding = cloudPadding,\n      spiral = archimedeanSpiral,\n      words = [],\n      timeInterval = Infinity,\n      event = dispatch(\"word\", \"end\"),\n      timer = null,\n      random = Math.random,\n      cloud = {},\n      canvas = cloudCanvas;\n\n  cloud.canvas = function (_) {\n    return arguments.length ? (canvas = functor(_), cloud) : canvas;\n  };\n\n  cloud.start = function () {\n    var contextAndRatio = getContext(canvas()),\n        board = zeroArray((size[0] >> 5) * size[1]),\n        bounds = null,\n        n = words.length,\n        i = -1,\n        tags = [],\n        data = words.map(function (d, i) {\n      d.text = text.call(this, d, i);\n      d.font = font.call(this, d, i);\n      d.style = fontStyle.call(this, d, i);\n      d.weight = fontWeight.call(this, d, i);\n      d.rotate = rotate.call(this, d, i);\n      d.size = ~~fontSize.call(this, d, i);\n      d.padding = padding.call(this, d, i);\n      return d;\n    }).sort(function (a, b) {\n      return b.size - a.size;\n    });\n    if (timer) clearInterval(timer);\n    timer = setInterval(step, 0);\n    step();\n    return cloud;\n\n    function step() {\n      var start = Date.now();\n\n      while (Date.now() - start < timeInterval && ++i < n && timer) {\n        var d = data[i];\n        d.x = size[0] * (random() + .5) >> 1;\n        d.y = size[1] * (random() + .5) >> 1;\n        cloudSprite(contextAndRatio, d, data, i);\n\n        if (d.hasText && place(board, d, bounds)) {\n          tags.push(d);\n          event.call(\"word\", cloud, d);\n          if (bounds) cloudBounds(bounds, d);else bounds = [{\n            x: d.x + d.x0,\n            y: d.y + d.y0\n          }, {\n            x: d.x + d.x1,\n            y: d.y + d.y1\n          }]; // Temporary hack\n\n          d.x -= size[0] >> 1;\n          d.y -= size[1] >> 1;\n        }\n      }\n\n      if (i >= n) {\n        cloud.stop();\n        event.call(\"end\", cloud, tags, bounds);\n      }\n    }\n  };\n\n  cloud.stop = function () {\n    if (timer) {\n      clearInterval(timer);\n      timer = null;\n    }\n\n    return cloud;\n  };\n\n  function getContext(canvas) {\n    canvas.width = canvas.height = 1;\n    var ratio = Math.sqrt(canvas.getContext(\"2d\").getImageData(0, 0, 1, 1).data.length >> 2);\n    canvas.width = (cw << 5) / ratio;\n    canvas.height = ch / ratio;\n    var context = canvas.getContext(\"2d\");\n    context.fillStyle = context.strokeStyle = \"red\";\n    context.textAlign = \"center\";\n    return {\n      context: context,\n      ratio: ratio\n    };\n  }\n\n  function place(board, tag, bounds) {\n    var perimeter = [{\n      x: 0,\n      y: 0\n    }, {\n      x: size[0],\n      y: size[1]\n    }],\n        startX = tag.x,\n        startY = tag.y,\n        maxDelta = Math.sqrt(size[0] * size[0] + size[1] * size[1]),\n        s = spiral(size),\n        dt = random() < .5 ? 1 : -1,\n        t = -dt,\n        dxdy,\n        dx,\n        dy;\n\n    while (dxdy = s(t += dt)) {\n      dx = ~~dxdy[0];\n      dy = ~~dxdy[1];\n      if (Math.min(Math.abs(dx), Math.abs(dy)) >= maxDelta) break;\n      tag.x = startX + dx;\n      tag.y = startY + dy;\n      if (tag.x + tag.x0 < 0 || tag.y + tag.y0 < 0 || tag.x + tag.x1 > size[0] || tag.y + tag.y1 > size[1]) continue; // TODO only check for collisions within current bounds.\n\n      if (!bounds || !cloudCollide(tag, board, size[0])) {\n        if (!bounds || collideRects(tag, bounds)) {\n          var sprite = tag.sprite,\n              w = tag.width >> 5,\n              sw = size[0] >> 5,\n              lx = tag.x - (w << 4),\n              sx = lx & 0x7f,\n              msx = 32 - sx,\n              h = tag.y1 - tag.y0,\n              x = (tag.y + tag.y0) * sw + (lx >> 5),\n              last;\n\n          for (var j = 0; j < h; j++) {\n            last = 0;\n\n            for (var i = 0; i <= w; i++) {\n              board[x + i] |= last << msx | (i < w ? (last = sprite[j * w + i]) >>> sx : 0);\n            }\n\n            x += sw;\n          }\n\n          delete tag.sprite;\n          return true;\n        }\n      }\n    }\n\n    return false;\n  }\n\n  cloud.timeInterval = function (_) {\n    return arguments.length ? (timeInterval = _ == null ? Infinity : _, cloud) : timeInterval;\n  };\n\n  cloud.words = function (_) {\n    return arguments.length ? (words = _, cloud) : words;\n  };\n\n  cloud.size = function (_) {\n    return arguments.length ? (size = [+_[0], +_[1]], cloud) : size;\n  };\n\n  cloud.font = function (_) {\n    return arguments.length ? (font = functor(_), cloud) : font;\n  };\n\n  cloud.fontStyle = function (_) {\n    return arguments.length ? (fontStyle = functor(_), cloud) : fontStyle;\n  };\n\n  cloud.fontWeight = function (_) {\n    return arguments.length ? (fontWeight = functor(_), cloud) : fontWeight;\n  };\n\n  cloud.rotate = function (_) {\n    return arguments.length ? (rotate = functor(_), cloud) : rotate;\n  };\n\n  cloud.text = function (_) {\n    return arguments.length ? (text = functor(_), cloud) : text;\n  };\n\n  cloud.spiral = function (_) {\n    return arguments.length ? (spiral = spirals[_] || _, cloud) : spiral;\n  };\n\n  cloud.fontSize = function (_) {\n    return arguments.length ? (fontSize = functor(_), cloud) : fontSize;\n  };\n\n  cloud.padding = function (_) {\n    return arguments.length ? (padding = functor(_), cloud) : padding;\n  };\n\n  cloud.random = function (_) {\n    return arguments.length ? (random = _, cloud) : random;\n  };\n\n  cloud.on = function () {\n    var value = event.on.apply(event, arguments);\n    return value === event ? cloud : value;\n  };\n\n  return cloud;\n};\n\nfunction cloudText(d) {\n  return d.text;\n}\n\nfunction cloudFont() {\n  return \"serif\";\n}\n\nfunction cloudFontNormal() {\n  return \"normal\";\n}\n\nfunction cloudFontSize(d) {\n  return Math.sqrt(d.value);\n}\n\nfunction cloudRotate() {\n  return (~~(Math.random() * 6) - 3) * 30;\n}\n\nfunction cloudPadding() {\n  return 1;\n} // Fetches a monochrome sprite bitmap for the specified text.\n// Load in batches for speed.\n\n\nfunction cloudSprite(contextAndRatio, d, data, di) {\n  if (d.sprite) return;\n  var c = contextAndRatio.context,\n      ratio = contextAndRatio.ratio;\n  c.clearRect(0, 0, (cw << 5) / ratio, ch / ratio);\n  var x = 0,\n      y = 0,\n      maxh = 0,\n      n = data.length;\n  --di;\n\n  while (++di < n) {\n    d = data[di];\n    c.save();\n    c.font = d.style + \" \" + d.weight + \" \" + ~~((d.size + 1) / ratio) + \"px \" + d.font;\n    var w = c.measureText(d.text + \"m\").width * ratio,\n        h = d.size << 1;\n\n    if (d.rotate) {\n      var sr = Math.sin(d.rotate * cloudRadians),\n          cr = Math.cos(d.rotate * cloudRadians),\n          wcr = w * cr,\n          wsr = w * sr,\n          hcr = h * cr,\n          hsr = h * sr;\n      w = Math.max(Math.abs(wcr + hsr), Math.abs(wcr - hsr)) + 0x1f >> 5 << 5;\n      h = ~~Math.max(Math.abs(wsr + hcr), Math.abs(wsr - hcr));\n    } else {\n      w = w + 0x1f >> 5 << 5;\n    }\n\n    if (h > maxh) maxh = h;\n\n    if (x + w >= cw << 5) {\n      x = 0;\n      y += maxh;\n      maxh = 0;\n    }\n\n    if (y + h >= ch) break;\n    c.translate((x + (w >> 1)) / ratio, (y + (h >> 1)) / ratio);\n    if (d.rotate) c.rotate(d.rotate * cloudRadians);\n    c.fillText(d.text, 0, 0);\n    if (d.padding) c.lineWidth = 2 * d.padding, c.strokeText(d.text, 0, 0);\n    c.restore();\n    d.width = w;\n    d.height = h;\n    d.xoff = x;\n    d.yoff = y;\n    d.x1 = w >> 1;\n    d.y1 = h >> 1;\n    d.x0 = -d.x1;\n    d.y0 = -d.y1;\n    d.hasText = true;\n    x += w;\n  }\n\n  var pixels = c.getImageData(0, 0, (cw << 5) / ratio, ch / ratio).data,\n      sprite = [];\n\n  while (--di >= 0) {\n    d = data[di];\n    if (!d.hasText) continue;\n    var w = d.width,\n        w32 = w >> 5,\n        h = d.y1 - d.y0; // Zero the buffer\n\n    for (var i = 0; i < h * w32; i++) {\n      sprite[i] = 0;\n    }\n\n    x = d.xoff;\n    if (x == null) return;\n    y = d.yoff;\n    var seen = 0,\n        seenRow = -1;\n\n    for (var j = 0; j < h; j++) {\n      for (var i = 0; i < w; i++) {\n        var k = w32 * j + (i >> 5),\n            m = pixels[(y + j) * (cw << 5) + (x + i) << 2] ? 1 << 31 - i % 32 : 0;\n        sprite[k] |= m;\n        seen |= m;\n      }\n\n      if (seen) seenRow = j;else {\n        d.y0++;\n        h--;\n        j--;\n        y++;\n      }\n    }\n\n    d.y1 = d.y0 + seenRow;\n    d.sprite = sprite.slice(0, (d.y1 - d.y0) * w32);\n  }\n} // Use mask-based collision detection.\n\n\nfunction cloudCollide(tag, board, sw) {\n  sw >>= 5;\n  var sprite = tag.sprite,\n      w = tag.width >> 5,\n      lx = tag.x - (w << 4),\n      sx = lx & 0x7f,\n      msx = 32 - sx,\n      h = tag.y1 - tag.y0,\n      x = (tag.y + tag.y0) * sw + (lx >> 5),\n      last;\n\n  for (var j = 0; j < h; j++) {\n    last = 0;\n\n    for (var i = 0; i <= w; i++) {\n      if ((last << msx | (i < w ? (last = sprite[j * w + i]) >>> sx : 0)) & board[x + i]) return true;\n    }\n\n    x += sw;\n  }\n\n  return false;\n}\n\nfunction cloudBounds(bounds, d) {\n  var b0 = bounds[0],\n      b1 = bounds[1];\n  if (d.x + d.x0 < b0.x) b0.x = d.x + d.x0;\n  if (d.y + d.y0 < b0.y) b0.y = d.y + d.y0;\n  if (d.x + d.x1 > b1.x) b1.x = d.x + d.x1;\n  if (d.y + d.y1 > b1.y) b1.y = d.y + d.y1;\n}\n\nfunction collideRects(a, b) {\n  return a.x + a.x1 > b[0].x && a.x + a.x0 < b[1].x && a.y + a.y1 > b[0].y && a.y + a.y0 < b[1].y;\n}\n\nfunction archimedeanSpiral(size) {\n  var e = size[0] / size[1];\n  return function (t) {\n    return [e * (t *= .1) * Math.cos(t), t * Math.sin(t)];\n  };\n}\n\nfunction rectangularSpiral(size) {\n  var dy = 4,\n      dx = dy * size[0] / size[1],\n      x = 0,\n      y = 0;\n  return function (t) {\n    var sign = t < 0 ? -1 : 1; // See triangular numbers: T_n = n * (n + 1) / 2.\n\n    switch (Math.sqrt(1 + 4 * sign * t) - sign & 3) {\n      case 0:\n        x += dx;\n        break;\n\n      case 1:\n        y += dy;\n        break;\n\n      case 2:\n        x -= dx;\n        break;\n\n      default:\n        y -= dy;\n        break;\n    }\n\n    return [x, y];\n  };\n} // TODO reuse arrays?\n\n\nfunction zeroArray(n) {\n  var a = [],\n      i = -1;\n\n  while (++i < n) {\n    a[i] = 0;\n  }\n\n  return a;\n}\n\nfunction cloudCanvas() {\n  return document.createElement(\"canvas\");\n}\n\nfunction functor(d) {\n  return typeof d === \"function\" ? d : function () {\n    return d;\n  };\n}\n\nvar spirals = {\n  archimedean: archimedeanSpiral,\n  rectangular: rectangularSpiral\n};"],"sourceRoot":""}