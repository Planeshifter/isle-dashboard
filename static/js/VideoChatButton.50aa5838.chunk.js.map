{"version":3,"sources":["../node_modules/@isle-project/components/video-chat-button/main.js"],"names":["debug","logger","VideoChatButton","props","event","opened","state","onClick","setState","session","context","for","joinVideoChat","name","subject","leaveVideoChat","this","unsubscribe","subscribe","type","value","VIDEO_CHAT_STARTED","VIDEO_CHAT_ENDED","RECEIVED_JITSI_TOKEN","RECEIVED_USER_RIGHTS","forceUpdate","label","variant","tooltip","t","buttonLabel","buttonVariant","jitsi","disabled","size","className","style","aria-disabled","aria-label","id","button","toggleVideoChat","pointerEvents","showTooltip","placement","tooltipPlacement","user","Component","defaultProps","contextType","SessionContext","withTranslation"],"mappings":"kPAeMA,EAAQC,IAAQ,0BAchBC,E,kDACL,WAAaC,GAAS,IAAD,6BACpB,cAAOA,GADa,8CA+BH,SAAEC,GACnB,IAAMC,GAAU,EAAKC,MAAMD,OAC3B,EAAKF,MAAMI,QAASH,EAAOC,GAC3B,EAAKG,SAAS,CACbH,WACE,WACF,IAAMI,EAAU,EAAKC,QAChBL,GACJL,EAAM,2CAAD,OAA6C,EAAKG,MAAMQ,IAAxD,SACLF,EAAQG,cAAc,CACrBC,KAAM,EAAKV,MAAMQ,IACjBG,QAAS,EAAKX,MAAMW,SAAW,EAAKX,MAAMQ,QAG3CX,EAAM,4CAAD,OAA8C,EAAKG,MAAMQ,IAAzD,SACLF,EAAQM,eAAgB,EAAKZ,MAAMQ,YA3CrC,EAAKL,MAAQ,CACZD,QAAQ,GAJW,E,qDAQrB,WAAqB,IAAD,OACbI,EAAUO,KAAKN,QACrBM,KAAKC,YAAcR,EAAQS,WAAW,SAAEC,EAAMC,GACxCD,IAASE,KAAsBD,IAAU,EAAKjB,MAAMQ,IACxD,EAAKH,SAAS,CACbH,QAAQ,IAGAc,IAASG,KAAoBF,IAAU,EAAKjB,MAAMQ,IAC3D,EAAKH,SAAS,CACbH,QAAQ,IAGAc,IAASI,KAAwBJ,IAASK,KACnD,EAAKC,mB,kCAKR,WACCT,KAAKC,gB,oBAuBN,WACC,IAEIS,EAMAC,EAoBAC,EA5BEnB,EAAUO,KAAKN,QACbmB,EAAMb,KAAKb,MAAX0B,EAaR,GAVCH,EADIV,KAAKb,MAAM2B,YACPd,KAAKb,MAAM2B,YAEXd,KAAKV,MAAMD,OAASwB,EAAE,SAAWA,EAAE,QAI3CF,EADIX,KAAKb,MAAM4B,cACLf,KAAKb,MAAM4B,cAEXf,KAAKV,MAAMD,OAAS,UAAY,aAErCI,EAAQuB,MACb,OAAS,kBAAC,IAAD,CACRC,UAAQ,EACRpB,KAAK,aACLc,QAASA,EACTO,KAAMlB,KAAKb,MAAM+B,KACjBC,UAAWnB,KAAKb,MAAMgC,UACtBC,MAAOpB,KAAKb,MAAMiC,MAClBC,gBAAc,OACdC,aAAYT,EAAE,aAEbH,GAKFE,EADIZ,KAAKb,MAAMyB,QACLZ,KAAKb,MAAMyB,QAEXZ,KAAKV,MAAMD,OAASwB,EAAE,WAAY,CAAEU,GAAIvB,KAAKb,MAAMQ,MAASkB,EAAE,UAAW,CAAEU,GAAIvB,KAAKb,MAAMQ,MAErG,IAAI6B,EAAS,kBAAC,IAAD,CACZ3B,KAAK,aACLc,QAASA,EACTO,KAAMlB,KAAKb,MAAM+B,KACjBC,UAAWnB,KAAKb,MAAMgC,UACtB5B,QAASS,KAAKyB,gBACdL,MAAOpB,KAAKb,MAAMiC,MAClBE,aAAYT,EAAE,WAEd,0BAAMO,MAAO,CAAEM,cAAe,SAC5BhB,IAYH,OATKV,KAAKb,MAAMwC,cACfH,EAAS,kBAAC,IAAD,CACRZ,QAASA,EACTgB,UAAW5B,KAAKb,MAAM0C,kBAErBL,IAKF,kBAAC,IAAD,CAAMM,MAAI,GACRN,O,GA/GyBO,aAqI9B7C,EAAgB8C,aAAe,CAC9BlC,QAAS,KACTgB,YAAa,KACba,aAAa,EACbT,KAAM,KACNH,cAAe,KACfc,iBAAkB,MAClBtC,QAP8B,aAQ9B4B,UAAW,GACXC,MAAO,IAGRlC,EAAgB+C,YAAcC,IAKfC,sBAAiB,QAAjBA,CAA4BjD","file":"static/js/VideoChatButton.50aa5838.chunk.js","sourcesContent":["// MODULES //\n\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport logger from 'debug';\nimport { withTranslation } from 'react-i18next';\nimport Button from 'react-bootstrap/Button';\nimport Tooltip from '@isle-project/components/tooltip';\nimport Gate from '@isle-project/components/gate';\nimport SessionContext from '@isle-project/session/context.js';\nimport { RECEIVED_JITSI_TOKEN, RECEIVED_USER_RIGHTS, VIDEO_CHAT_STARTED, VIDEO_CHAT_ENDED } from '@isle-project/constants/events.js';\n\n\n// VARIABLES //\n\nconst debug = logger( 'isle:video-chat-button' );\n\n\n// MAIN //\n\n/**\n* A button for joining and leaving video chats.\n*\n* @property {string} for - chat room identifier\n* @property {boolean} showTooltip - controls whether to show tooltip\n* @property {string} size - button size\n* @property {string} tooltipPlacement - position of button tooltip\n* @property {Object} style - CSS inline styles\n*/\nclass VideoChatButton extends Component {\n\tconstructor( props ) {\n\t\tsuper( props );\n\n\t\tthis.state = {\n\t\t\topened: false\n\t\t};\n\t}\n\n\tcomponentDidMount() {\n\t\tconst session = this.context;\n\t\tthis.unsubscribe = session.subscribe( ( type, value ) => {\n\t\t\tif ( type === VIDEO_CHAT_STARTED && value === this.props.for ) {\n\t\t\t\tthis.setState({\n\t\t\t\t\topened: true\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if ( type === VIDEO_CHAT_ENDED && value === this.props.for ) {\n\t\t\t\tthis.setState({\n\t\t\t\t\topened: false\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if ( type === RECEIVED_JITSI_TOKEN || type === RECEIVED_USER_RIGHTS ) {\n\t\t\t\tthis.forceUpdate();\n\t\t\t}\n\t\t});\n\t}\n\n\tcomponentWillUnmount() {\n\t\tthis.unsubscribe();\n\t}\n\n\ttoggleVideoChat = ( event ) => {\n\t\tconst opened = !this.state.opened;\n\t\tthis.props.onClick( event, opened );\n\t\tthis.setState({\n\t\t\topened\n\t\t}, () => {\n\t\t\tconst session = this.context;\n\t\t\tif ( opened ) {\n\t\t\t\tdebug( `Should join chat for component with id '${this.props.for}'...` );\n\t\t\t\tsession.joinVideoChat({\n\t\t\t\t\tname: this.props.for,\n\t\t\t\t\tsubject: this.props.subject || this.props.for\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tdebug( `Should leave chat for component with id '${this.props.for}'...` );\n\t\t\t\tsession.leaveVideoChat( this.props.for );\n\t\t\t}\n\t\t});\n\t}\n\n\trender() {\n\t\tconst session = this.context;\n\t\tconst { t } = this.props;\n\t\tlet label;\n\t\tif ( this.props.buttonLabel ) {\n\t\t\tlabel = this.props.buttonLabel;\n\t\t} else {\n\t\t\tlabel = this.state.opened ? t('leave') : t('join');\n\t\t}\n\t\tlet variant;\n\t\tif ( this.props.buttonVariant ) {\n\t\t\tvariant = this.props.buttonVariant;\n\t\t} else {\n\t\t\tvariant = this.state.opened ? 'success' : 'secondary';\n\t\t}\n\t\tif ( !session.jitsi ) {\n\t\t\treturn ( <Button\n\t\t\t\tdisabled\n\t\t\t\tname=\"Video Chat\"\n\t\t\t\tvariant={variant}\n\t\t\t\tsize={this.props.size}\n\t\t\t\tclassName={this.props.className}\n\t\t\t\tstyle={this.props.style}\n\t\t\t\taria-disabled=\"true\"\n\t\t\t\taria-label={t('disabled')}\n\t\t\t>\n\t\t\t\t{label}\n\t\t\t</Button> );\n\t\t}\n\t\tlet tooltip;\n\t\tif ( this.props.tooltip ) {\n\t\t\ttooltip = this.props.tooltip;\n\t\t} else {\n\t\t\ttooltip = this.state.opened ? t('leave-id', { id: this.props.for }) : t('join-id', { id: this.props.for });\n\t\t}\n\t\tlet button = <Button\n\t\t\tname=\"Video Chat\"\n\t\t\tvariant={variant}\n\t\t\tsize={this.props.size}\n\t\t\tclassName={this.props.className}\n\t\t\tonClick={this.toggleVideoChat}\n\t\t\tstyle={this.props.style}\n\t\t\taria-label={t('toggle')}\n\t\t>\n\t\t\t<span style={{ pointerEvents: 'none' }} >\n\t\t\t\t{label}\n\t\t\t</span>\n\t\t</Button>;\n\t\tif ( this.props.showTooltip ) {\n\t\t\tbutton = <Tooltip\n\t\t\t\ttooltip={tooltip}\n\t\t\t\tplacement={this.props.tooltipPlacement}\n\t\t\t>\n\t\t\t\t{button}\n\t\t\t</Tooltip>;\n\t\t}\n\t\t/* eslint-disable jsx-a11y/click-events-have-key-events, jsx-a11y/no-noninteractive-element-interactions, jsx-a11y/no-static-element-interactions */\n\t\treturn (\n\t\t\t<Gate user >\n\t\t\t\t{button}\n\t\t\t</Gate>\n\t\t);\n\t}\n}\n\n\n// PROPERTIES //\n\nVideoChatButton.propTypes = {\n\tfor: PropTypes.string.isRequired,\n\tsubject: PropTypes.string,\n\tbuttonLabel: PropTypes.node,\n\tshowTooltip: PropTypes.bool,\n\tsize: PropTypes.string,\n\tbuttonVariant: PropTypes.string,\n\ttooltipPlacement: PropTypes.oneOf([ 'left', 'top', 'right', 'bottom' ]),\n\tonClick: PropTypes.func,\n\tclassName: PropTypes.string,\n\tstyle: PropTypes.object\n};\n\nVideoChatButton.defaultProps = {\n\tsubject: null,\n\tbuttonLabel: null,\n\tshowTooltip: true,\n\tsize: 'sm',\n\tbuttonVariant: null,\n\ttooltipPlacement: 'top',\n\tonClick() {},\n\tclassName: '',\n\tstyle: {}\n};\n\nVideoChatButton.contextType = SessionContext;\n\n\n// EXPORTS //\n\nexport default withTranslation( 'Video' )( VideoChatButton );\n"],"sourceRoot":""}